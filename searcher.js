"use strict";const main=e=>{const t="search",s="highlight",n=document.getElementById("search-wrapper"),r=document.getElementById("searchbar"),o=document.getElementById("searchresults"),a=document.getElementById("search-toggle");let c=[],l={teaser_word_count:30,limit_results:30},d={bool:"AND",expand:!0,fields:{title:{boost:1},body:{boost:1},breadcrumbs:{boost:0}}},i=0;const u=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},h=e=>{const t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,params:(()=>{const e={},s=t.search.replace(/^\?/,"").split("&");let n=0;for(;n<s.length;n++){if(!s[n])continue;const t=s[n].split("=");e[t[0]]=t[1]}return e})(),file:(t.pathname.match(/\/([^/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^/])/,"/$1")}},m=(()=>{const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},t=t=>e[t];return e=>e.replace(/[&<>'"]/g,t)})(),p=(e,t)=>{const n=f(m(e.doc.body),t);i++;const r=c[e.ref].split("#");1==r.length&&r.push("");const o=encodeURIComponent(t.join(" ")).replace(/\'/g,"%27");return'<a href="'+document.getElementById("searcher").dataset.pathtoroot+r[0]+"?"+s+"="+o+"#"+r[1]+'" aria-details="teaser_'+i+'">'+e.doc.breadcrumbs+'</a><span class="teaser" id="teaser_'+i+'" aria-label="Search Result Teaser">'+n+"</span>"},f=(e,t)=>{const s=t.map((function(e){return elasticlunr.stemmer(e.toLowerCase())}));let n=0,r=0,o=!1;const a=[];if(e.toLowerCase().split(". ").forEach((e=>{const t=e.split(" ");r=8,t.forEach((e=>{e.length>0&&(s.forEach((t=>{elasticlunr.stemmer(e).startsWith(t)&&(r=40,o=!0)})),a.push([e,r,n]),r=2),n+=e.length,n+=1})),n+=1})),0==a.length)return e;const c=[],d=Math.min(a.length,l.teaser_word_count);let i=0;for(let e=0;e<d;e++)i+=a[e][1];c.push(i);for(let e=0;e<a.length-d;e++)i-=a[e][1],i+=a[e+d][1],c.push(i);let u=0;if(o){let e=0;for(let t=c.length-1;t>=0;t--)c[t]>e&&(e=c[t],u=t)}else u=0;const h=[];let m=a[u][2];for(let t=u;t<u+d;t++){const s=a[t];m<s[2]&&(h.push(e.substring(m,s[2])),m=s[2]),40==s[1]&&h.push("<em>"),m=s[2]+s[0].length,h.push(e.substring(s[2],m)),40==s[1]&&h.push("</em>")}return h.join("")},w=()=>{n.classList.remove("hidden"),a.setAttribute("aria-expanded","true")},g=()=>{n.classList.add("hidden"),a.setAttribute("aria-expanded","false"),null!=o.length&&o.children.forEach((e=>e.classList.remove("focus")))},b=e=>{const i=new Mark(document.querySelector("main")),m=[];l=e.results_options,d=e.search_options,c=e.doc_urls,a.addEventListener("click",(()=>{n.classList.contains("hidden")?(w(),window.scrollTo(0,0),r.select()):g()}),{once:!1,passive:!0});const f=()=>{const n=r.value.trim();""!=n?(r.classList.add("active"),(t=>{u(o);const s=elasticlunr.Index.load(e.index).search(t,d),n=Math.min(s.length,l.limit_results);document.getElementById("searchresults-header").innerText=(s.length>n?"Over ":"")+n+" search results for: "+t;const r=t.split(" ");for(let e=0;e<n;e++){const t=document.createElement("li");t.innerHTML=p(s[e],r),o.appendChild(t)}document.getElementById("searchresults-outer").classList.remove("hidden")})(n)):(r.classList.remove("active"),document.getElementById("searchresults-outer").classList.add("hidden"),u(o)),i.unmark();const a=h(window.location.href);delete a.params[s],""!=n?(a.params[t]=n,a.hash=""):delete a.params[t]};document.addEventListener("keyup",(e=>{if("Escape"!=e.key)return void f();g();const t=document.createElement("input");t.setAttribute("style","position: absolute; opacity: 0;"),a.appendChild(t),t.focus(),t.remove()}),{once:!1,passive:!0});const b=()=>{const e=h(window.location.href);e.params.hasOwnProperty.call(t)&&""!=e.params[t]?(w(),r.value=decodeURIComponent((e.params[t]+"").replace(/\+/g,"%20")),f()):g(),e.params.hasOwnProperty(s)&&(i.mark(decodeURIComponent(e.params[s]).split(" "),{exclude:m}),document.querySelectorAll("mark").forEach((e=>{e.addEventListener("click",i.unmark,{once:!0,passive:!0})})))};window.onpopstate=()=>{b()},document.addEventListener("submit",(e=>{e.preventDefault()}),{once:!1,passive:!1}),b()},E=document.getElementById("searcher").dataset.pathtoroot+"searchindex";fetch(E+".json").then((e=>e.json())).then((e=>b(e))).catch((()=>{const t=document.createElement("script");t.src=E+".js",t.onload=()=>b(e),document.head.appendChild(t)}));e.hasFocus=()=>r===document.activeElement},fzfInit=()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,n=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>n.find(e).map((e=>{const{item:t,score:n}=e;return{doc:s[t],ref:t,score:n}}))}}};Mark&&elasticlunr&&(window.search=window.search||{},document.addEventListener("DOMContentLoaded",(()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,n=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>n.find(e).map((e=>{const{item:t,score:n}=e;return{doc:s[t],ref:t,score:n}}))}},main(window.search)}),{once:!0,passive:!0}));