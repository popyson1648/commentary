"use strict";const main=e=>{const t="search",s="highlight",r=document.getElementById("searchbar"),n=document.getElementById("search-wrapper"),o=document.getElementById("searchresults"),a=document.getElementById("search-toggle");let c=[],l={teaser_word_count:30,limit_results:30},d={bool:"AND",expand:!0,fields:{title:{boost:1},body:{boost:1},breadcrumbs:{boost:0}}};const i=(e,t,r)=>{const n=c[t.ref].split("#");1==n.length&&n.push("");const o=e+1;return'<a href="'+document.getElementById("searcher").dataset.pathtoroot+n[0]+"?"+s+"="+r+"#"+n[1]+'" aria-details="teaser_'+o+'">'+t.doc.breadcrumbs+'</a><span class="teaser" id="teaser_'+o+'" aria-label="Search Result Teaser">'+((e,t)=>{const s=[];let r=0,n=0,o=!1;if(e.toLowerCase().split(". ").forEach((e=>{const a=e.split(" ");r=8,a.forEach((e=>{e.length>0&&(t.map((e=>elasticlunr.stemmer(e.toLowerCase()))).forEach((t=>{elasticlunr.stemmer(e).startsWith(t)&&(r=40,o=!0)})),s.push([e,r,n]),r=2),n+=e.length,n+=1})),n+=1})),0==s.length)return e;const a=Math.min(s.length,l.teaser_word_count),c=(()=>{const e=[];let t=0;for(let e=0;e<a;e++)t+=s[e][1];e.push(t);for(let r=0;r<s.length-a;r++)t-=s[r][1],t+=s[r+a][1],e.push(t);return e})(),d=(()=>{if(!o)return 0;let e=0,t=0;for(let s=c.length-1;s>=0;s--)c[s]>e&&(e=c[s],t=s);return t})(),i=[];let h=s[d][2];const u=t=>{h=t[2]+t[0].length,i.push(e.substring(t[2],h))};for(let t=d;t<d+a;t++){const r=s[t];h<r[2]&&(i.push(e.substring(h,r[2])),h=r[2]),40==r[1]?(i.push("<em>"),u(r),i.push("</em>")):u(r)}return i.join("")})(t.doc.body,r)+"</span>"},h=()=>{n.classList.remove("hidden"),a.setAttribute("aria-expanded","true")},u=()=>{n.classList.add("hidden"),a.setAttribute("aria-expanded","false"),null!=o.length&&o.children.forEach((e=>e.classList.remove("focus")))},m=e=>{const m=new Mark(document.querySelector("main")),p=[];l=e.results_options,d=e.search_options,c=e.doc_urls,a.addEventListener("click",(()=>{n.classList.contains("hidden")?(h(),window.scrollTo(0,0),r.select()):u()}),{once:!1,passive:!0});const f=e=>{const t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,params:(()=>{const e={};return t.search.replace(/^\?/,"").split("&").forEach((t=>{if(t){const s=t.split("=");e[s[0]]=s[1]}})),e})(),file:(t.pathname.match(/\/([^/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^/])/,"/$1")}},w=()=>{const n=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},a=r.value.trim();""!=a?(r.classList.add("active"),(t=>{n(o);const s=elasticlunr.Index.load(e.index).search(t,d),r=Math.min(s.length,l.limit_results);document.getElementById("searchresults-header").innerText=(s.length>r?"Over ":"")+r+" search results for: "+t;const a=t.split(" ");for(let e=0;e<r;e++){const t=document.createElement("li");t.innerHTML=i(e,s[e],a),o.appendChild(t)}document.getElementById("searchresults-outer").classList.remove("hidden")})(a)):(r.classList.remove("active"),document.getElementById("searchresults-outer").classList.add("hidden"),n(o)),m.unmark();const c=f(window.location.href);delete c.params[s],""!=a?(c.params[t]=a,c.hash=""):delete c.params[t]};document.addEventListener("keyup",(e=>{if("Escape"!=e.key)return void w();u();const t=document.createElement("input");t.setAttribute("style","position: absolute; opacity: 0;"),a.appendChild(t),t.focus(),t.remove()}),{once:!1,passive:!0});const g=()=>{const e=f(window.location.href);e.params.hasOwnProperty.call(t)&&""!=e.params[t]?(h(),r.value=decodeURIComponent((e.params[t]+"").replace(/\+/g,"%20")),w()):u(),e.params.hasOwnProperty(s)&&(m.mark(decodeURIComponent(e.params[s]).split(" "),{exclude:p}),document.querySelectorAll("mark").forEach((e=>{e.addEventListener("click",m.unmark,{once:!0,passive:!0})})))};window.onpopstate=()=>g(),document.addEventListener("submit",(e=>{e.preventDefault()}),{once:!1,passive:!1}),g()},p=document.getElementById("searcher").dataset.pathtoroot+"searchindex";fetch(p+".json").then((e=>e.json())).then((e=>m(e))).catch((()=>{console.log("Try to load searchindex.js if fetch failed");const t=document.createElement("script");t.src=p+".js",t.onload=()=>m(e),document.head.appendChild(t)})),e.hasFocus=()=>r===document.activeElement},fzfInit=()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,r=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>r.find(e).map((e=>{const{item:t,score:r}=e;return{doc:s[t],ref:t,score:r}}))}}};Mark&&elasticlunr&&(window.search=window.search||{},document.addEventListener("DOMContentLoaded",(()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,r=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>r.find(e).map((e=>{const{item:t,score:r}=e;return{doc:s[t],ref:t,score:r}}))}},main(window.search)}),{once:!0,passive:!0}));