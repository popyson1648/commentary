"use strict";const main=e=>{const t="search",s="highlight",n=document.getElementById("searchbar"),o=document.getElementById("search-wrapper"),r=document.getElementById("searchresults"),a=document.getElementById("search-toggle");let c=[],l={teaser_word_count:30,limit_results:30},d={bool:"AND",expand:!0,fields:{title:{boost:1},body:{boost:1},breadcrumbs:{boost:0}}};const i=(e,t,n)=>{const o=c[t.ref].split("#");1==o.length&&o.push("");const r=e+1;return'<a href="'+document.getElementById("searcher").dataset.pathtoroot+o[0]+"?"+s+"="+n+"#"+o[1]+'" aria-details="teaser_'+r+'">'+t.doc.breadcrumbs+'</a><span class="teaser" id="teaser_'+r+'" aria-label="Search Result Teaser">'+((e,t)=>{const s=t.map((e=>elasticlunr.stemmer(e.toLowerCase()))),n=[];let o=0,r=0,a=!1;if(e.toLowerCase().split(". ").forEach((e=>{const t=e.split(" ");o=8,t.forEach((e=>{e.length>0&&(s.forEach((t=>{elasticlunr.stemmer(e).startsWith(t)&&(o=40,a=!0)})),n.push([e,o,r]),o=2),r+=e.length,r+=1})),r+=1})),0==n.length)return e;const c=Math.min(n.length,l.teaser_word_count);let d=0;for(let e=0;e<c;e++)d+=n[e][1];const i=[];i.push(d);for(let e=0;e<n.length-c;e++)d-=n[e][1],d+=n[e+c][1],i.push(d);let h=0;if(a){let e=0;for(let t=i.length-1;t>=0;t--)i[t]>e&&(e=i[t],h=t)}else h=0;const u=[];let m=n[h][2];const p=t=>{m=t[2]+t[0].length,u.push(e.substring(t[2],m))};for(let t=h;t<h+c;t++){const s=n[t];m<s[2]&&(u.push(e.substring(m,s[2])),m=s[2]),40==s[1]?(u.push("<em>"),p(s),u.push("</em>")):p(s)}return u.join("")})(t.doc.body,n)+"</span>"},h=()=>{o.classList.remove("hidden"),a.setAttribute("aria-expanded","true")},u=()=>{o.classList.add("hidden"),a.setAttribute("aria-expanded","false"),null!=r.length&&r.children.forEach((e=>e.classList.remove("focus")))},m=e=>{const m=new Mark(document.querySelector("main")),p=[];l=e.results_options,d=e.search_options,c=e.doc_urls,a.addEventListener("click",(()=>{o.classList.contains("hidden")?(h(),window.scrollTo(0,0),n.select()):u()}),{once:!1,passive:!0});const f=e=>{const t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,params:(()=>{const e={},s=t.search.replace(/^\?/,"").split("&");let n=0;for(;n<s.length;n++){if(!s[n])continue;const t=s[n].split("=");e[t[0]]=t[1]}return e})(),file:(t.pathname.match(/\/([^/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^/])/,"/$1")}},w=()=>{const o=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},a=n.value.trim();""!=a?(n.classList.add("active"),(t=>{o(r);const s=elasticlunr.Index.load(e.index).search(t,d),n=Math.min(s.length,l.limit_results);document.getElementById("searchresults-header").innerText=(s.length>n?"Over ":"")+n+" search results for: "+t;const a=t.split(" ");for(let e=0;e<n;e++){const t=document.createElement("li");t.innerHTML=i(e,s[e],a),r.appendChild(t)}document.getElementById("searchresults-outer").classList.remove("hidden")})(a)):(n.classList.remove("active"),document.getElementById("searchresults-outer").classList.add("hidden"),o(r)),m.unmark();const c=f(window.location.href);delete c.params[s],""!=a?(c.params[t]=a,c.hash=""):delete c.params[t]};document.addEventListener("keyup",(e=>{if("Escape"!=e.key)return void w();u();const t=document.createElement("input");t.setAttribute("style","position: absolute; opacity: 0;"),a.appendChild(t),t.focus(),t.remove()}),{once:!1,passive:!0});const g=()=>{const e=f(window.location.href);e.params.hasOwnProperty.call(t)&&""!=e.params[t]?(h(),n.value=decodeURIComponent((e.params[t]+"").replace(/\+/g,"%20")),w()):u(),e.params.hasOwnProperty(s)&&(m.mark(decodeURIComponent(e.params[s]).split(" "),{exclude:p}),document.querySelectorAll("mark").forEach((e=>{e.addEventListener("click",m.unmark,{once:!0,passive:!0})})))};window.onpopstate=()=>g(),document.addEventListener("submit",(e=>{e.preventDefault()}),{once:!1,passive:!1}),g()},p=document.getElementById("searcher").dataset.pathtoroot+"searchindex";fetch(p+".json").then((e=>e.json())).then((e=>m(e))).catch((()=>{console.log("Try to load searchindex.js if fetch failed");const t=document.createElement("script");t.src=p+".js",t.onload=()=>m(e),document.head.appendChild(t)})),e.hasFocus=()=>n===document.activeElement},fzfInit=()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,n=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>n.find(e).map((e=>{const{item:t,score:n}=e;return{doc:s[t],ref:t,score:n}}))}}};Mark&&elasticlunr&&(window.search=window.search||{},document.addEventListener("DOMContentLoaded",(()=>{window.elasticlunr.Index.load=e=>{const t=window.fzf.Fzf,s=e.documentStore.docs,n=new t(Object.keys(s),{selector:e=>{const t=s[e];return t.text=`${t.title}${t.breadcrumbs}${t.body}`,t.text}});return{search:e=>n.find(e).map((e=>{const{item:t,score:n}=e;return{doc:s[t],ref:t,score:n}}))}},main(window.search)}),{once:!0,passive:!0}));