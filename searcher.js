"use strict";const rootPath=document.getElementById("searcher").dataset.pathtoroot;window.search=window.search||{},(e=>{if(!Mark||!elasticlunr)return;const t=document.getElementById("search-wrapper"),s=document.getElementById("searchbar"),r=document.getElementById("searchresults"),a=document.getElementById("searchresults-outer"),o=document.getElementById("searchresults-header"),n=document.getElementById("search-toggle"),c="search",l="highlight";let i=null,h=[],d={teaser_word_count:30,limit_results:30},p={bool:"AND",expand:!0,fields:{title:{boost:1},body:{boost:1},breadcrumbs:{boost:0}}};const u=[],m=new Mark(document.getElementById("content"));let f="",_=0;const g=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},w=e=>{const t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,params:(()=>{const e={},s=t.search.replace(/^\?/,"").split("&");let r=0;for(;r<s.length;r++){if(!s[r])continue;const t=s[r].split("=");e[t[0]]=t[1]}return e})(),file:(t.pathname.match(/\/([^/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^/])/,"/$1")}},E=e=>{let t=e.protocol+"://"+e.host;""!=e.port&&(t+=":"+e.port),t+=e.path;let s="?";for(const r in e.params)e.params.hasOwnProperty.call(r)&&(t+=s+r+"="+e.params[r],s="&");return""!=e.hash&&(t+="#"+e.hash),t},v=(()=>{const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},t=t=>e[t];return e=>e.replace(/[&<>'"]/g,t)})(),y=(e,t)=>{const s=b(v(e.doc.body),t);_++;const r=h[e.ref].split("#");1==r.length&&r.push("");const a=encodeURIComponent(t.join(" ")).replace(/\'/g,"%27");return'<a href="'+rootPath+r[0]+"?"+l+"="+a+"#"+r[1]+'" aria-details="teaser_'+_+'">'+e.doc.breadcrumbs+'</a><span class="teaser" id="teaser_'+_+'" aria-label="Search Result Teaser">'+s+"</span>"},b=(e,t)=>{const s=t.map((function(e){return elasticlunr.stemmer(e.toLowerCase())}));let r=0,a=0,o=!1;const n=[];if(e.toLowerCase().split(". ").forEach((e=>{const t=e.split(" ");a=8,t.forEach((e=>{e.length>0&&(s.forEach((t=>{elasticlunr.stemmer(e).startsWith(t)&&(a=40,o=!0)})),n.push([e,a,r]),a=2),r+=e.length,r+=1})),r+=1})),0==n.length)return e;const c=[],l=Math.min(n.length,d.teaser_word_count);let i=0;for(let e=0;e<l;e++)i+=n[e][1];c.push(i);for(let e=0;e<n.length-l;e++)i-=n[e][1],i+=n[e+l][1],c.push(i);let h=0;if(o){let e=0;for(let t=c.length-1;t>=0;t--)c[t]>e&&(e=c[t],h=t)}else h=0;const p=[];let u=n[h][2];for(let t=h;t<h+l;t++){const s=n[t];u<s[2]&&(p.push(e.substring(u,s[2])),u=s[2]),40==s[1]&&p.push("<em>"),u=s[2]+s[0].length,p.push(e.substring(s[2],u)),40==s[1]&&p.push("</em>")}return p.join("")},L=e=>{d=e.results_options,p=e.search_options,h=e.doc_urls,i=elasticlunr.Index.load(e.index),n.addEventListener("click",(()=>{t.classList.contains("hidden")?(I(!0),window.scrollTo(0,0),s.select()):I(!1)}),{once:!1,passive:!0});const _=e=>{e?a.classList.remove("hidden"):a.classList.add("hidden")},v=()=>{const e=s.value.trim();""!=e?(s.classList.add("active"),(e=>{if(f==e)return;if(f=e,!i)return;const t=i.search(e,p),s=Math.min(t.length,d.limit_results);o.innerText=((e,t)=>0==e?"No search results for '"+t+"'.":1==e?e+" search result for '"+t+"':":e+" search results for '"+t+"':")(s,e);const a=e.split(" ");g(r);for(let e=0;e<s;e++){const s=document.createElement("li");s.innerHTML=y(t[e],a),r.appendChild(s)}_(!0)})(e)):(s.classList.remove("active"),_(!1),g(r)),((e,t)=>{const s=w(window.location.href),r=!s.params.hasOwnProperty.call(c);""!=e||"push_if_new_search_else_replace"==t?(s.params[c]=e,delete s.params[l],s.hash=""):(delete s.params[l],delete s.params[c]),"push"==t||"push_if_new_search_else_replace"==t&&r?history.pushState({},document.title,E(s)):("replace"==t||"push_if_new_search_else_replace"==t&&!r)&&history.replaceState({},document.title,E(s))})(e,"push_if_new_search_else_replace"),m.unmark()};document.addEventListener("keyup",(e=>{if("Escape"!=e.key)return void v();I(!1);const t=document.createElement("input");t.setAttribute("style","position: absolute; opacity: 0;"),n.appendChild(t),t.focus(),t.remove()}),{once:!1,passive:!0});const b=()=>{const e=w(window.location.href);if(e.params.hasOwnProperty.call(c)&&""!=e.params[c]?(I(!0),s.value=decodeURIComponent((e.params[c]+"").replace(/\+/g,"%20")),v()):I(!1),e.params.hasOwnProperty.call(l)){m.mark(decodeURIComponent(e.params[l]).split(" "),{exclude:u});const t=document.querySelectorAll("mark"),s=()=>{t.forEach((e=>e.classList.add("fade-out")))};t.forEach((e=>{e.addEventListener("click",s,{once:!1,passive:!0})})),globalThis.setTimeout((()=>{m.unmark()}),300)}};window.onpopstate=()=>{b()},document.addEventListener("submit",(e=>{e.preventDefault()}),{once:!1,passive:!1}),b()},I=e=>{if(e)t.classList.remove("hidden"),n.setAttribute("aria-expanded","true");else{t.classList.add("hidden"),n.setAttribute("aria-expanded","false");const e=r.children;for(let t=0;t<e.length;t++)e[t].classList.remove("focus")}};fetch(rootPath+"searchindex.json").then((e=>e.json())).then((e=>L(e))).catch((()=>{const e=document.createElement("script");e.src=rootPath+"searchindex.js",e.onload=()=>L(window.search),document.head.appendChild(e)})),e.hasFocus=()=>s===document.activeElement})(window.search);